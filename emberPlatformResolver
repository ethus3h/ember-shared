#!/usr/bin/env bash

#set -x

app="$1"
shift

if [[ -z "$app" ]]; then
    [[ "$emberPlatformResolver" == "true" ]] && exit 0
    [[ -z "$app" ]] && app="bash"
fi

emberPlatformResolver="true"
export emberPlatformResolver

if [[ "$OSTYPE" = darwin* ]]; then
    if ! [[ -e "$(which "g$app")" ]]; then
        printf '%b' '\033[1;31m' >&2
        echo "Please run emberMacGNUUpgrade, and then restart your command." >&2
        printf '%b' '\033[0m' >&2
        exit 1
    else
        exec "g$app" "$@"
    fi
else
    exec "$app" "$@"
fi
